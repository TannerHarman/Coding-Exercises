"undefined"===typeof window.AMP&&(AMP={});(function(a){AMP.cps=function(a){return new AMP.cps.fn(a)};AMP.cps.fn=function(b){function c(b){switch(AMP.utils.getEventKeyCode(b)){case 27:AMP.utils.removeElementChild(d.cps.suggestionsContainer);break;case 13:case 37:case 38:case 39:case 40:break;default:b=AMP.utils.getInputValue(d.cps.searchBox),g!==b&&(g=b,""===g?AMP.utils.removeElementChild(d.cps.suggestionsContainer):(clearTimeout(m),m=a.setTimeout(function(){e(g)},50)))}}function e(a){AMP.utils.ajaxJsonp(d.cps.settings.apiUrl+"&qt="+a,function(a,b){AMP.utils.removeElementById(b);var c=d.cps.suggestionsContainer;if(a&&(a.paid_suggestions||a.organic_suggestions)){var p=AMP.utils.createElement("UL");if(a.paid_suggestions)for(var l=a.paid_suggestions,f=0;f<l.length;f++){var e=l[f],g=AMP.utils.createElement("LI"),n=AMP.utils.createElement("A"),m=AMP.utils.createElement("IMG"),q=AMP.utils.createElement("IMG"),r=AMP.utils.createElement("SPAN");AMP.utils.setElementInnerText(r,e.term);AMP.utils.addElementAttribute(n,"href",e.click_url);AMP.utils.addElementAttribute(n,"target","_blank");AMP.utils.addElementAttribute(m,"src",e.image_url);AMP.utils.addElementAttribute(q,"src",e.impression_url);AMP.utils.addElementAttribute(q,"className","amp_impression_pixel");AMP.utils.appendElementChild(n,m);AMP.utils.appendElementChild(n,r);AMP.utils.appendElementChild(g,n);AMP.utils.appendElementChild(p,g)}if(a.organic_suggestions)for(l=a.organic_suggestions,f=0;f<l.length;f++)e=l[f],g=AMP.utils.createElement("LI"),AMP.utils.setElementInnerText(g,e.term),AMP.utils.appendElementChild(p,g)}AMP.utils.removeElementChild(c);h=[];k=0;"undefined"!==typeof p&&(AMP.utils.appendElementChild(c,p),h[0]=d.cps.searchBox,h=h.concat([].slice.call(AMP.utils.getElementsByTagName("li",c))))},function(a){AMP.utils.removeElementById(a)})}function f(a){var b=AMP.utils.getEventKeyCode(a);if(40===b||38===b)a.preventDefault(),a=d.cps.searchBox,AMP.utils.getElementChild(d.cps.suggestionsContainer)[0]&&(b=40===b?1:h.length-1,AMP.utils.removeElementClass(h[k],"amp_selected"),k=(k+b)%h.length,AMP.utils.addElementClass(h[k],"amp_selected"),b=(b=AMP.utils.getElementChild(h[k])[0])&&"a"===AMP.utils.getElementTagName(b)?b:h[0],AMP.utils.focusElement(b),0===k?AMP.utils.setInputValue(a,g):AMP.utils.setInputValue(a,AMP.utils.getElementInnerText(h[k])))}var g="",m,h=[],k=0,d=this;d.cps={settings:b,searchBox:AMP.utils.getElementById(b.searchBoxId),suggestionsContainer:AMP.utils.getElementById(b.suggestionsContainerId)};(function(){AMP.utils.addEventListener(d.cps.searchBox,"keyup",c);AMP.utils.addEventListener(a.document,"click",function(){AMP.utils.removeElementChild(d.cps.suggestionsContainer)});AMP.utils.addEventListener(d.cps.searchBox,"click",function(a){a.stopPropagation()});AMP.utils.addEventListener(d.cps.suggestionsContainer,"click",function(a){AMP.utils.setInputValue(d.cps.searchBox,"");a=AMP.utils.getEventCurrentTarget(a);if("li"!==AMP.utils.getElementTagName(a))return!0;if(d.cps.settings.formId){var b=AMP.utils.getElementById(d.cps.settings.formId);AMP.utils.setInputValue(d.cps.searchBox,AMP.utils.getElementInnerText(a));b.submit()}});AMP.utils.addEventListener(d.cps.searchBox,"keydown",f);AMP.utils.addEventListener(d.cps.suggestionsContainer,"keydown",f)})()};return a.AMP.cps=AMP.cps})(window);AMP.utils=function(){return{addEventListener:function(a,b,c,e){if(a.addEventListener)return a.addEventListener(b,function(a){"undefined"!==typeof c&&null!=c&&c(a)},e),!0;if(a.attachEvent)return a.attachEvent("on"+b,function(a){"undefined"!==typeof c&&null!=c&&c(a)},e);a["on"+b]=function(){"undefined"!==typeof c&&null!=c&&c()}},getEventKeyCode:function(a){return"undefined"!==a.keyCode?a.keyCode:window.event.keyCode},getEventCurrentTarget:function(a){return"undefined"!==typeof a.srcElement?a.srcElement:"undefined"!==typeof a.target?a.target:window.event.srcElement},getElementById:function(a){return document.getElementById(a)},getElementsByClassName:function(a,b){return b?b.getElementsByClassName(a):document.getElementsByClassName(a)},getElementsByTagName:function(a,b){return b?b.getElementsByTagName(a):document.getElementsByTagName(a)},createElement:function(a){return document.createElement(a)},removeElementById:function(a){(a=this.getElementById(a))&&a.parentNode.removeChild(a)},getElementChild:function(a){return a.children},removeElementChild:function(a){for(;a&&a.firstChild;)a.removeChild(a.firstChild)},appendElementChild:function(a,b){a&&b&&a.appendChild(b)},addElementAttribute:function(a,b,c){a&&a.setAttribute(b,c)},setElementInnerText:function(a,b){a&&(a.innerText?a.innerText=b:a.textContent=b)},getInputValue:function(a){if(a)return a.value},setInputValue:function(a,b){a&&"undefined"!==typeof b&&(a.value=b)},ajaxJsonp:function(a,b,c){var e="amp_"+this.createRandomNumber();window[e]=function(a){b(a,e)};var f=AMP.utils.createElement("SCRIPT");f.id=e;f.src=a+"&callback="+e;f.onerror=function(){c(e)};AMP.utils.appendElementChild(AMP.utils.getElementsByTagName("head")[0],f)},createRandomNumber:function(){for(var a=(new Date).getTime().toString().substr(5),b=0;2>b;b++)a+=Math.floor(65536*(1+Math.random())).toString();return a.substr(0,18)},addElementClass:function(a,b){a&&b&&a.classList.add(b)},removeElementClass:function(a,b){a&&b&&a.classList.remove(b)},getElementInnerText:function(a){if(a)return a.innerText},focusElement:function(a){a&&a.focus()},getParentElement:function(a){if(a)return a.parentElement},getElementTagName:function(a){if(a)return a.tagName.toLowerCase()}}}();
Drupal.cmd.push(function(){
(function($){$('#search-block-form--2').attr("autocomplete","off");$("#search-form").attr("autocomplete","off").after('<div style="position:relative"><div id="amp_suggestions_container2" class="amp-suggestions"></div></div>');if(document.getElementById("edit-keys")){var search_text=document.getElementById("edit-keys").value;var ad_marketplace_data={"endpoint":"https:\/\/newsweek_search.ampfeed.com\/xmlamp\/feed?out=json&qt="+search_text+"&partner=newsweek_search&sub1=newsweek.com&results=3&v=7&ua="+encodeURIComponent(navigator.userAgent)+"&rfr="+encodeURIComponent(location.href),"suggest_endpoint":"https://newsweek_cps.cps.ampfeed.com/suggestions?partner=newsweek_cps&sub1=newsweek.com&v=1.2&results-os=1&results-ps=1","sponsored_text":"Sponsored","ads_by_text":"Ads by adMarketplace"};if(!ad_marketplace_data.suggest_endpoint){return};if($('body').hasClass('search-results')||$('body').hasClass('search-no-results')||ad_marketplace_data.endpoint){$.ajax({url:ad_marketplace_data.endpoint,data:{},type:"GET",dataType:"jsonp",success:function(data){add_sponsored_search_results(data)}})}}function add_sponsored_search_results(data){if(!data||0==data.count){return}var wrapperEl=$('<div />',{class:'ad-marketplace-wrapper'});wrapperEl.hide();var sponsorWrapperEl=$('<div />',{class:'ad-marketplace-sponsored-wrapper'});sponsorWrapperEl.append($('<div />',{class:'ad-marketplace-sponsored-text',text:ad_marketplace_data.sponsored_text}));sponsorWrapperEl.append($('<div />',{class:'ad-marketplace-sponsored-ads-by',text:ad_marketplace_data.ads_by_text}));wrapperEl.append(sponsorWrapperEl);var resultsWrapperEl=$('<div />',{class:'ad-marketplace-search-results-wrapper'});for(var i=0;i<3;i++){if(typeof data.adlistings.listing[i]==='undefined'||!data.adlistings.listing[i]){continue}if(0!==i){resultsWrapperEl.append($('<div />',{class:"ad-marketplace-search-separator"}))}resultsWrapperEl.append(get_html_from_data(data.adlistings.listing[i]))}wrapperEl.append(resultsWrapperEl);if($('body').hasClass('page-search-site')){$('.archive-list').prepend(wrapperEl)}$('.ad-marketplace-wrapper').fadeIn()}function get_html_from_data(data){var resultEl=$('<div />',{class:"ad-marketplace-search-result"});var headlineEl=$('<h3 />',{class:"ad-marketplace-search-result-title"});var headlineLinkEl=$('<a />',{href:data.clickurl,target:"_blank",text:data.title});headlineEl.append(headlineLinkEl);resultEl.append(headlineEl);var domainEl=$('<p />',{class:"ad-marketplace-search-result-link",text:data.displayurl.replace(/^(.+?)\/*?$/,"$1")});resultEl.append(domainEl);var descriptionEl=$('<p />',{class:"ad-marketplace-search-result-description",text:data.description});resultEl.append(descriptionEl);if(data.impressionurl){resultEl.append($('<img />',{src:data.impressionurl,width:1,height:1,border:0,style:'float: left;'}))}return resultEl}
})(jQuery);
AMP.cps({searchBoxId:"edit-search-block-form--4",suggestionsContainerId:"amp_suggestions_container1",formId:"search-block-form--2",apiUrl:admarketplace_apiUrl});if(document.getElementById("search-form")){AMP.cps({searchBoxId:"edit-keys",suggestionsContainerId:"amp_suggestions_container2",formId:"search-form",apiUrl:admarketplace_apiUrl})}
});